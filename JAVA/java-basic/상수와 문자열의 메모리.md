잘 준비를 마치고 유튜브에서 우연히 자바강의를 찾아서 홀린듯이 보게되었다.

자바를 구조적으로 프로그래밍 하는 방법을 알려주는 강의였다. 그 중 마지막 강의를 보게 되었는데 코드 실행과 함수 호출 스택에 대한 내용을 다루었다.

자바 프로그램이 실행되어 프로세스가 되고, 프로세스의 실행 순서에 따라 코드, 레퍼런스 혹은 일반 변수, 인스턴스가 각각 text, stack, heap 영역에 어떻게 저장되는지 알 수 있었다.

프로그램이 실행되면 작성한 코드들이 바이너리 형식으로 text영역에 로드된다. 이후 main 함수가 호출되기 전에 main함수에 필요한 변수들이 stack 영역에 로딩되고, 인스턴스가 생성되면 동적 메모리 공간인 heap영역에 할당되며 레퍼런스 변수는 heap 메모리 주소값을 가진다.

프로세스가 실행되며 더 이상 참조되지 않는 인스턴스는 가비지 컬렉터에 의해 메모리에서 해제된다.

이 강의를 듣고 일반 변수는 값을 어떻게 저장하는지 궁금해져 찾아보게 되었다.

10이라는 정수 리터럴을 a에 저장한다고 가정하자.

```java
int a = 10;
```

리터럴은 메소드 영역(GC의 관리 대상이 아니다, logical 하게는 heap에 속한다.)의 Runtime Constant Pool 이라는 메모리 영역에 할당되며 변수는 이를 참조하게 된다. (constant는 상수, 불변의 등의 의미를 가진다.)

다시 10이라는 정수를 b에 저장한다고 가정하자.

b는 이전에 생성되었던 Constant Pool의 리터럴 10을 참조하며 a 와 b는 동일한 주소를 가리키게 되고 a==b가 성립되는 것이다. ( == 는 주소값을 비교한다 )

그렇다면 String은 어떻게 값을 저장할까

Java 7 이후부터는 String Constant Pool 이 Heap 영역에 저장되어 CG의 대상이 되었다고 공식문서는 말한다.

```java
String str = "문자열";
```

먼저 String 타입 변수 str이 Stack 프레임 영역에 저장된다. 이후 “문자열”은 Heap 영역의 String Constance Pool 영역에 저장되고, 변수 str 은 “문자열”의 주소값을 가리키게 된다.


---

메소드 영역은 heap과 구분되어 설명되나 logical하게는 heap영역에 속한다.

[Java 런타임 데이터 영역](https://8iggy.tistory.com/229)